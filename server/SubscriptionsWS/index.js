/*=======================================================================================================
/*========================================//* Requires *//*==============================================
/*=====================================================================================================*/
const express = require('express')
const app = express()
require("dotenv").config();
const connectDB = require('./config/db');
const bodyParser = require('body-parser');

/*=======================================================================================================
/*================================//* Use Environment Variable *//*======================================
/*=====================================================================================================*/
const { API_PORT } = process.env;
const port = process.env.PORT || API_PORT;
const { MONGO_URI } = process.env;

/*=======================================================================================================
/*====================================//* Connect Database *//*==========================================
/*=====================================================================================================*/
connectDB();

/*=======================================================================================================
/*=======================================//* Middlewares *//*============================================
/*=====================================================================================================*/

// Parse incoming request bodies in a middleware before the handlers, 
// available under the 'req.body' property
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({
    extended: true
}));

/*=======================================================================================================
/*================================//* Create a session middleware *//*===================================
/*=====================================================================================================*/

/*=======================================================================================================
/*==================================//* Routers - Logic goes here *//*===================================
/*=====================================================================================================*/

const membersRouter = require('./routers/membersRouter');
app.use('/members', membersRouter);

const moviesRouter = require('./routers/moviesRouter');
app.use('/movies', moviesRouter);

const subscriptionsRouter = require('./routers/subscriptionsRouter');
app.use('/subscriptions', subscriptionsRouter);

/*=======================================================================================================
/*====================================//* server listening *//*==========================================
/*=====================================================================================================*/
app.listen(port, () => {
    console.log(`-----------------------------------------------------------`)
    console.log(`- Subscription server is running at http://localhost:${port} -`)
    console.log(`-----------------------------------------------------------`)
});